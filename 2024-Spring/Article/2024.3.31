第二章 论文技术基础
1、自回归生成模型
3、拉普拉斯编码介绍
4、多头注意力机制介绍
5、transformer解码器架构
6、rdkit化学包介绍
7、one-hot coding 独热编码：在蛋白质氨基酸图的构建里面采用到的
K-NN算法：也是在氨基酸残基图里面用到的
三、蛋白质口袋导向分子生成模型构建
3.1模型构建
3.1.1蛋白质口袋表征
3.1.2蛋白质编码器
3.1.3分子类药性质编码器
3.1.4分子生成解码器

3.2参数设置
3.2.1模型训练和优化测率
3.2.2训练参数设置

3.3数据集

3.1模型构建
蛋白质口袋，是蛋白质表面与配体分子结合的特定区域。本研究旨在实现一个基于深度学习的以蛋白质口袋为导向的分子生成方法，使得生成的分子能够以高结合亲和力与特定蛋白质结合。即给定一种新的蛋白质p_x，任务是生成一组新的分子{{m}_x^k,k=1,2,...}，这组分子能够以高结合亲和力与p_x结合，并具有所需的相关类药性质d_x。以下是框架的具体构建。
3.1.1蛋白质口袋表征
为了获取蛋白质口袋的结构信息，需要将其表征为计算机能够识别处理的内容。给定一个3D蛋白质结构，为了表征该蛋白质的结合口袋，为其分别构建一个氨基酸残基图和一个原子图，分别代表了该蛋白质口袋的粗粒度表示和细粒度表示。
对氨基酸残基图的构建来说，根据20种氨基酸残基的类型，将每个残基视作一个图节点，为了将这些点的离散取值扩展到欧式空间，以方便合理计算点之间的距离，每个节点采用独热编码。之后，采用K=48的K-NN算法进行两个节点之间边的构造。
对原子图的构建而言，选取了常用的6种原子类型：H, C, N, O, S, P，同样地采用独热编码，每个原子作为一个图节点，并额外添加一位对该原子是否为骨架进行注释（1表示该原子在骨架中的位置，0表示不在）。之后，采用K=30的K-NN算法进行两个节点之间边的构造。
因为采用的解码器Transformer，其位置编码很难定义图中节点的位置，为了获取节点的唯一位置表示，引入了拉普拉斯位置编码，为整个蛋白质口袋图增加了位置信息。
3.1.2蛋白质口袋编码
在解码器生成分子之前，需要获得一个完整的蛋白质结合口袋表示，将上述氨基酸残基图和原子图结合。在这个过程中，为了使模型能够更好地捕捉口袋结构和功能信息，减少噪声干扰，获得节点及节点之间的准确信息，捕获不同节点间的交互模式，丰富单个节点内容，提高分子生成性能，需要对两个图进行边缘增强并使用多头注意力机制。
将两图分别嵌入一个并行编码器中，每个编码器包含一个多个串联编码单元，每个单元又包含边缘增强编码块和多头注意力机制块。经过注意力机制更新后，节点表示会通过一个前馈网络（FNN）进行进一步的处理。
在这个过程中，虽然对氨基酸残基图和原子图进行并行节点增强处理，但为了更好地捕获蛋白质口袋的天然层次结构，需要对二者进行融合。我们将氨基酸残基图是为粗粒度表示，将原子图是为细粒度表示，采用交叉注意力块对两个表示进行融合。因为是氨基酸缔合其包含的原子，故而将交叉注意力块输出的结果单向用于更新氨基酸残基图（粗粒度）的表示。此外，为避免信息冗余，仅只对中间编码单元和最后一个编码单元采用交叉注意力机制进行粗粒度和细粒度的交叉融合，并更新粗粒度信息。
最终，更新后的节点表示被用作下一个编码单元的输入，或者作为整个图编码过程的输出。对氨基酸残基图和原子图进行并行编码后的节点表示矩阵被垂直堆叠，输入最后的分子生成解码器中。
3.1.3分子类药性质编码器
我有点没懂这里，就是参看了制药邦的解说，这里说编码类药性质和蛋白质结合分数在smiles序列之前，然后讲了自回归的条件生成模型。那么这里是不是开始生成分子了呢？还是说这个也是模型训练的一环？不如回归代码看一下。

